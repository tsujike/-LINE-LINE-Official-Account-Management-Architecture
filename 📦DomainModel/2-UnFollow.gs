/**ãƒ–ãƒ­ãƒƒã‚¯æ™‚ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ */
class UnFollow {
  /**Â 
     *Â @constructor
     *Â @param{object}Â Webhookã‚¤ãƒ™ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
     */
  constructor(event) {

    //ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ä½¿ã„ãªãŒã‚‰ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚‚ä½¿ã†ã®ã§
    this.event = event;

    //ã¾ãæ„å‘³ãªã„ã‹ã‚‚ã ã‘ã©ã€ã¡ã‚ƒã‚“ã¨Enumã‹ã‚‰å–å¾—ã—ã‚ˆã†ã­
    this.name = ENUM_DomainObject.UnFollow.name;

    this.userMessage = "ãƒ–ãƒ­ãƒƒã‚¯ğŸ˜¨";

    this.timestamp = Utilities.formatDate(new Date(event.timestamp), "JST", "yyyyMMdd_hh:mm:ss");
    this.sourceUserId = event.source.userId;
  }

  /** ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã¨è¨€ãˆã‚‹èª²é¡Œè§£æ±ºãƒ¡ã‚½ãƒƒãƒ‰ */
  getSolution() {

    //ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«å‡ºåŠ›
    const d = new DataSheet();
    d.appendRowUnfollowEvent(this.event);

    //æˆåŠŸå‡¦ç†ï¼Ÿ
    const ADMIN_EMAIL = PropertiesService.getScriptProperties().getProperty("ADMIN_EMAIL");
    GmailApp.sendEmail(ADMIN_EMAIL, "ã€[LINE]LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€Delicious Seafood Supplier in Hokkaidoã€ã€‘ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ", "æ°—ã«ã—ãªã„ã§ã„ãã¾ã—ã‚‡ã†");

    return "UnFollowã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯èª²é¡Œã‚’è§£æ±ºã—ãŸã®ã§ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ"

  }

  /** ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåˆ¤å®šãƒ¡ã‚½ãƒƒãƒ‰ */
  isDomainObject() {
    return this.event.type === "unfollow" ? true : false
  }


}